<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset = "UTF-8">
	<meta name = "viewport" content = "width=device-width, initial-scale = 1.0">
	<title>æŠ•ç¨¿è©³ç´°- FoodBoard</title>
	
	<!--Bootstrap CSS-->
	<link href = "https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
	
	<style> 
	.mobile-container{
		    max-width: 430px; 
		    margin: 0 auto; 
		    min-height: 100vh;  /* âœ… height â†’ min-height ë³€ê²½ */
		    background-color: #ffffff;
		    border-left: 1px solid #f0f0f0;
		    border-right: 1px solid #f0f0f0;
		    display: flex;
		    flex-direction: column; 
		    padding: 0;
		    overflow-y: auto;  /* âœ… ì¶”ê°€ */
		}
	header 	{
		    position: sticky; 
		    top: 0;
		    z-index: 1020; 
		    width: 100%; 
		    background-color: #ffecd9;
		    flex-shrink: 0;  /* âœ… ì¶”ê°€ */
		}

		/* âœ… ê²Œì‹œê¸€ ì˜ì—­ */
		main {
		    flex-shrink: 0;
		}

		/* âœ… ëŒ“ê¸€ ì…ë ¥ì°½ ì˜ì—­ */
		.comment-input-area {
		    flex-shrink: 0;
		    border-top: 1px solid #dee2e6;
		}

		.comment-section {
		    flex-shrink: 0;
		    display: flex;
		    flex-direction: column;
		    /* max-heightì™€ overflow-y ì œê±° */
		}

		.comment-list {
		    flex: 1;
		    max-height: calc(100vh - 500px);  /* ì—¬ê¸°ë¡œ ì´ë™ */
		    overflow-y: auto;
		}

		/* âœ… ëŒ“ê¸€ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
		.edit-form {
		    display: none;
		}

		.reply-form {
		    display: none;
		}

		.comment-actions {
		    font-size: 0.85rem;
		}

		.comment-actions span,
		.comment-actions button {
		    cursor: pointer;
		}

		.comment-actions span:hover,
		.comment-actions button:hover {
		    opacity: 0.7;
		}
		
		/* âœ… textarea ë†’ì´ ê³ ì • */
		#commentInput {
		    resize: none !important;
		    overflow-y: auto;
		}
		/* âœ… ì •ë ¬ ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼ */
		.btn-sort-active {
		    background-color: #6c757d !important;
		    color: white !important;
		    border-color: #6c757d !important;
		}
		</style>
</head>

<body>
	<div class = "container-fluid px-0">
		<div class = "mobile-container">
			<header class = "d-flex justify-content-between align-items-center py-3 px-3"
					style = "background-color: #ffecd9; min-height: 85px;">
					
					<a th:href = "@{/board}"
						class = "d-inline-flex align-items-center"
						style = "cursor: pointer; font-size: 24px; text-decoration: none; color: black; line-height: 1;">ã€ˆ</a>
						
					<h5 class = "mb-0 fw-bold">ã‚°ãƒ«ãƒ¡æ²ç¤ºæ¿</h5>
					
				<div class = "dropdown">
					<span style = "cursor: pointer; font-size: 24px;" 
						   data-bs-toggle = "dropdown">â‹®</span>
					<ul class = "dropdown-menu dropdown-menu-end">
						<li>
							<a class="dropdown-item" th:href="@{/board/edit/{id}(id=${board.id})}">
								âœï¸ ä¿®æ­£ã™ã‚‹
							</a>
						</li>
						<li><hr class ="dropdown-divider"></li>
						<li>
							<a class = "dropdown-item text-danger" href = "#" onclick= "deletePost()">
								ğŸ—‘ï¸ å‰Šé™¤ã™ã‚‹
							</a>
						</li>
					</ul>
				</div>
				
		
			</header>
			<!--ê²Œì‹œê¸€ ë‚´ìš©-->
			<main class="flex-grow-1">
			    
				<!-- 1. ì§€ì—­ëª… + ë³„ì  + ì‘ì„±ì + ë‚ ì§œ (í•œ ì¤„) -->
				<div class="px-3 pt-3 d-flex justify-content-between align-items-center">
				    <div class="d-flex align-items-center gap-2">
				        <span class="badge bg-warning text-dark" th:text="${board.prefecture}"></span>
						<span class="text-warning fw-bold d-flex align-items-center gap-1">
							<img src="https://img.icons8.com/ios-filled/20/ffc107/star.png" alt="ë³„ì " style="width:18px; height:18px;">
							<span th:text="${board.rating}"></span>
				    	</span>
						</div>
				    <div class="small text-muted">
				        <span th:text="${#temporals.format(board.createdAt, 'MM/dd HH:mm')}"></span>
				        <span>|</span>
				        <span th:text="${board.user != null ? board.user.username : 'åŒ¿å'}"></span>
				    </div>
				</div>
			    
			    <!-- 2. ì œëª© -->
			    <div class="px-3 pt-2">
			        <h5 class="fw-bold mb-0" th:text="${board.title}"></h5>
			    </div>
			    
			    <!-- 3. ì´ë¯¸ì§€ (ì—¬ëŸ¬ ì¥, ì˜†ìœ¼ë¡œ ìŠ¤í¬ë¡¤) -->
				<div class="px-3 py-3" th:if="${board.imageUrls != null and !board.imageUrls.isEmpty()}">
				    <div class="d-flex gap-2"
				         style="overflow-x: auto; -webkit-overflow-scrolling: touch;">
				        <img th:each="url : ${board.imageUrls.split(',')}"
				             th:src="${url}" 
				             alt="æŠ•ç¨¿ã‚¤ãƒ¡ãƒ¼ã‚¸"
				             class="rounded flex-shrink-0"
				             style="width: 100%; max-width: 350px; height: 250px; object-fit: cover;">
				    </div>
			    
			        <!-- ì´ë¯¸ì§€ ì—†ì„ ë•Œ -->
			        <div th:if="${board.imageUrls == null or board.imageUrls.isEmpty()}"
			             class="bg-light rounded d-flex align-items-center justify-content-center"
			             style="height: 200px;">
			            <span class="text-muted">No Image</span>
			        </div>
			    </div>
			    
			    <!-- 4. ê¸€ ë‚´ìš© -->
			    <div class="px-3 py-2">
			        <p class="mb-0" style="line-height: 1.6;" th:text="${board.content}"></p>
			    </div>
				
			</main>
			
			<!-- âœ… ê²Œì‹œê¸€ ì¢‹ì•„ìš”/ëŒ“ê¸€ ë²„íŠ¼ ì¶”ê°€ -->
			<div class="px-3 py-3 border-top">
			    <div class="d-flex align-items-center gap-3">
			        <!-- ì¢‹ì•„ìš” -->
			        <form th:action="@{/board/like}" method="post" class="d-inline" onsubmit="return checkLoginForAction(event)">
			            <input type="hidden" name="boardId" th:value="${board.id}">
			            <button type="submit" class="btn btn-link btn-sm p-0 text-decoration-none text-muted">
			                <img th:src="${board.likedByMe ? 'https://img.icons8.com/ios-filled/22/ff6b6b/like.png' : 'https://img.icons8.com/ios/22/888888/like.png'}" 
			                     alt="like" style="vertical-align: middle;">
								 <span>ã„ã„ã­ï¼</span>
			                <span th:text="${board.likeCount}">0</span>
			            </button>
			        </form>
			        
					<!-- ëŒ“ê¸€ ê°œìˆ˜ (í´ë¦­ì‹œ ëŒ“ê¸€ í˜ì´ì§€ë¡œ ì´ë™) -->
					<span th:href="@{/post/{id}(id=${board.id})}" class="text-decoration-none text-muted">
					    <img src="https://img.icons8.com/ios/22/888888/comments.png" alt="comments" style="vertical-align: middle;">
					    <span>ã‚³ãƒ¡ãƒ³ãƒˆ</span>
					    <span th:text="${comments != null ? comments.size() : 0}">0</span>
					</span>
			    </div>
			</div>

			<!--ëŒ“ê¸€ ì„¹ì…˜ ì¶”ê°€ -->
			<div id="commentSection" class="comment-section">
				<!-- ëŒ“ê¸€ ì…ë ¥ -->
			    <div class="bg-white px-3 py-3" style="position: sticky; bottom: 0; z-index: 100; border-top: 1px solid #dee2e6;">
				    <form th:action="@{/board/comment/add}" method="post" onsubmit="return checkLoginForAction(event)">
				        <input type="hidden" name="boardId" th:value="${board.id}">
				        <textarea id="commentInput" 
				                  name="content" 
				                  class="form-control mb-2" 
				                  placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
				                  onclick="checkLoginForClick(event)" 
				                  rows="2"
				                  required></textarea>
				        <button type="submit"
				                class="btn btn-primary w-100 fw-bold rounded-pill py-2">
				          ç™»éŒ²
				        </button>
				    </form>
				</div>

			    <!-- ì •ë ¬ ë²„íŠ¼ -->
			    <div class="comment-section">
				    <!-- ì •ë ¬ ë²„íŠ¼ -->
				    <div class="px-3 py-3 bg-white border-bottom sticky-top" style="top: 0;">
				        <div class="d-flex justify-content-end gap-2">
							<button type="button" 
							        class="btn btn-sm btn-outline-secondary rounded-pill px-3" 
							        id="sort-newest" 
							        th:classappend="${sortOrder == 'newest' ? 'btn-sort-active' : ''}"
							        onclick="sortComments('newest')">
							    æ–°ç€é †
							</button>
							<button type="button" 
							        class="btn btn-sm btn-outline-secondary rounded-pill px-3" 
							        id="sort-oldest" 
							        th:classappend="${sortOrder == null or sortOrder == 'oldest' ? 'btn-sort-active' : ''}"
							        onclick="sortComments('oldest')">
							    æŠ•ç¨¿é †
							</button>
				        </div>
				    </div>
			    </div>
			    <!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ -->
			    <div class="comment-list">
					<div class="comment px-3 py-3 border-bottom"
					     th:each="comment : ${comments}"
					     th:id="'comment-' + ${comment.id}">
			            <div class="d-flex align-items-center gap-2 mb-2">
			                <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
			                <div th:if="${comment.user != null && comment.user.profileImageUrl != null}"
			                     class="rounded-circle"
			                     th:style="'background-image: url(' + ${comment.user.profileImageUrl} + '); background-size: cover; background-position: center; width: 32px; height: 32px;'">
			                </div>
			                <div th:unless="${comment.user != null && comment.user.profileImageUrl != null}"
			                     class="rounded-circle bg-secondary"
			                     style="width: 32px; height: 32px;">
			                </div>
			                
			                <!-- ì‚¬ìš©ì ì´ë¦„ -->
			                <span class="fw-semibold" 
			                      th:text="${comment.user != null ? comment.user.name : comment.author}">
			                    ãƒ¦ãƒ¼ã‚¶ãƒ¼
			                </span>
			                
			                <span class="text-muted small" 
			                      th:text="${comment.createdAt != null ? #temporals.format(comment.createdAt, 'yyyy-MM-dd HH:mm') : '2026-01-19 14:30'}">
			                    2026-01-19 14:30
			                </span>
			            </div>
			            
			            <!-- ëŒ“ê¸€ ë‚´ìš© -->
			            <div class="mb-2" th:text="${comment.content}" 
			                 th:id="'comment-content-' + ${comment.id}">
			                ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹
			            </div>
			            
			            <!-- ëŒ“ê¸€ ìˆ˜ì • í¼ -->
			            <div class="edit-form" th:id="'edit-form-' + ${comment.id}" style="display: none;">
			                <form th:action="@{/board/comment/edit}" method="post" onsubmit="return checkLoginForAction(event)">
			                    <input type="hidden" name="commentId" th:value="${comment.id}">
			                    <textarea name="content" class="form-control mb-2" th:text="${comment.content}" required></textarea>
			                    <div class="d-flex gap-2">
			                        <button type="submit" class="btn btn-sm btn-primary">ä¿å­˜</button>
			                        <button type="button" class="btn btn-sm btn-secondary"
			                                th:onclick="'toggleEdit(' + ${comment.id} + ')'">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
			                    </div>
			                </form>
			            </div>
			            
			            <!-- ëŒ“ê¸€ ì•¡ì…˜ -->
			            <div class="comment-actions d-flex align-items-center gap-2 small text-muted">
			                <!-- ì¢‹ì•„ìš” -->
			                <form th:action="@{/board/comment/like}" method="post" class="d-inline" onsubmit="return checkLoginForAction(event)">
			                    <input type="hidden" name="commentId" th:value="${comment.id}">
			                    <button type="submit" class="btn btn-link btn-sm p-0 text-decoration-none text-muted">
									<img th:src="${comment.likedByMe ? 'https://img.icons8.com/ios-filled/20/ff6b6b/like.png' : 'https://img.icons8.com/ios/20/888888/like.png'}" 
									     alt="like" style="vertical-align: middle;">
			                        <span th:text="${comment.likeCount}">0</span>
			                    </button>
			                </form>
			                
			                <!-- ëŒ€ëŒ“ê¸€ ìˆ˜ í‘œì‹œ -->
							<span th:onclick="'toggleReply(' + ${comment.id} + ')'"
							      class="d-flex align-items-center gap-1"
							      style="cursor:pointer;">
							    <img src="https://img.icons8.com/ios/20/888888/comments.png">
							    <span th:text="${comment.replies.size()}">0</span>
							</span>
			                
							<!-- ìˆ˜ì • -->
						  <span th:if="${session.loginUser != null && comment.user != null && session.loginUser.userId == comment.user.userId}"
						  th:onclick="'event.stopPropagation(); checkLoginAndToggleEdit(event,' + ${comment.id} + ')'"
						        style="cursor:pointer;">
								<img src="https://img.icons8.com/ios/20/888888/edit.png"
							         alt="edit"
							         style="vertical-align: middle;">
							    <span>ç·¨é›†</span>
						  </span>
			                
			                <!-- ì‚­ì œ -->
							<form th:if="${session.loginUser != null && comment.user != null && session.loginUser.userId == comment.user.userId}"
							      th:action="@{/board/comment/delete}" method="post" 
							      class="d-inline"
							      onsubmit="event.stopPropagation(); return checkLoginForAction(event) && confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹?');">
			                    <input type="hidden" name="commentId" th:value="${comment.id}">
								<button type="submit" class="btn btn-link btn-sm p-0 text-decoration-none text-muted">
								    <img src="https://img.icons8.com/ios/20/888888/delete.png" alt="delete" style="vertical-align: middle;"> å‰Šé™¤
								</button>
			                </form>
			            </div>
			            
			            <!-- ëŒ€ëŒ“ê¸€ ì…ë ¥ í¼ -->
			            <div class="reply-form mt-2" th:id="'reply-form-' + ${comment.id}" style="display: none;">
			                <form th:action="@{/board/comment/reply}" method="post" onsubmit="return checkLoginForAction(event)">
			                    <input type="hidden" name="parentId" th:value="${comment.id}">
			                    <textarea name="content" 
			                              class="form-control mb-2" 
			                              placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
			                              onclick="checkLoginForClick(event)" 
			                              required></textarea>
			                    <div class="d-flex gap-2">
			                        <button type="submit" class="btn btn-sm btn-danger">ç™»éŒ²</button>
			                        <button type="button" class="btn btn-sm btn-secondary"
			                                th:onclick="'toggleReply(' + ${comment.id} + ')'">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
			                    </div>
			                </form>
			            </div>
			            
			            <!-- ëŒ€ëŒ“ê¸€ ëª©ë¡ -->
			            <div th:if="${comment.replies != null && !comment.replies.isEmpty()}">
			                <div class="reply bg-light rounded px-2 py-2 ms-4 mt-2" th:each="reply : ${comment.replies}">
			                    <div class="d-flex align-items-center gap-2 mb-2">
			                        <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
			                        <div th:if="${reply.user != null && reply.user.profileImageUrl != null}"
			                             class="rounded-circle"
			                             th:style="'background-image: url(' + ${reply.user.profileImageUrl} + '); background-size: cover; background-position: center; width: 24px; height: 24px;'">
			                        </div>
			                        <div th:unless="${reply.user != null && reply.user.profileImageUrl != null}"
			                             class="rounded-circle bg-secondary"
			                             style="width: 24px; height: 24px;">
			                        </div>
			                        
			                        <!-- ì‚¬ìš©ì ì´ë¦„ -->
			                        <span class="fw-semibold small" 
			                              th:text="${reply.user != null ? reply.user.name : reply.author}">
			                            ãƒ¦ãƒ¼ã‚¶ãƒ¼
			                        </span>
			                        
			                        <span class="text-muted small" 
			                              th:text="${reply.createdAt != null ? #temporals.format(reply.createdAt, 'yyyy-MM-dd HH:mm') : '2026-01-19 14:35'}">
			                            2026-01-19 14:35
			                        </span>
			                    </div>
			                    
			                    <!-- ëŒ€ëŒ“ê¸€ ë‚´ìš© -->
			                    <div class="mb-2 small" th:text="${reply.content}" 
			                         th:id="'reply-content-' + ${comment.id} + '-' + ${reply.id}">
			                        ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹
			                    </div>
								
								<!-- âœ… ëŒ€ëŒ“ê¸€ ìˆ˜ì • í¼ ì¶”ê°€ -->
								        <div class="edit-form" th:id="'reply-edit-form-' + ${comment.id} + '-' + ${reply.id}" style="display: none;">
								            <form th:action="@{/board/comment/reply/edit}" method="post" onsubmit="return checkLoginForAction(event)">
								                <input type="hidden" name="parentId" th:value="${comment.id}">
								                <input type="hidden" name="replyId" th:value="${reply.id}">
								                <textarea name="content" class="form-control mb-2" th:text="${reply.content}" required></textarea>
								                <div class="d-flex gap-2">
								                    <button type="submit" class="btn btn-sm btn-primary">ä¿å­˜</button>
								                    <button type="button" class="btn btn-sm btn-secondary"
								                            th:onclick="'toggleReplyEdit(' + ${comment.id} + ',' + ${reply.id} + ')'">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
								                </div>
								            </form>
								        </div>
			                    
			                    <!-- ëŒ€ëŒ“ê¸€ ì•¡ì…˜ -->
			                    <div class="comment-actions small text-muted d-flex gap-2">
			                        <!-- ëŒ€ëŒ“ê¸€ ì¢‹ì•„ìš” -->
			                        <form th:action="@{/board/comment/reply/like}" method="post" class="d-inline" onsubmit="return checkLoginForAction(event)">
			                            <input type="hidden" name="parentId" th:value="${comment.id}">
			                            <input type="hidden" name="replyId" th:value="${reply.id}">
			                            <button type="submit" class="btn btn-link btn-sm p-0 text-decoration-none text-muted">
											<img th:src="${reply.likedByMe ? 'https://img.icons8.com/ios-filled/20/ff6b6b/like.png' : 'https://img.icons8.com/ios/20/888888/like.png'}" 
											     alt="like" style="vertical-align: middle;">
			                                <span th:text="${reply.likeCount}">0</span>
			                            </button>
			                        </form>
			                        
			                        <span th:if="${session.loginUser != null && reply.user != null && session.loginUser.userId == reply.user.userId}"
									      th:onclick="'checkLoginAndToggleReplyEdit(event,' + ${comment.id} + ',' + ${reply.id} + ')'" 
									      style="cursor:pointer;">
										  <img src="https://img.icons8.com/ios/20/888888/edit.png"
										       alt="edit"
										       style="vertical-align: middle;">
										  <span>ç·¨é›†</span>
									</span>
			                        
			                        <!-- ëŒ€ëŒ“ê¸€ ì‚­ì œ -->
			                        <form th:if="${session.loginUser != null && reply.user != null && session.loginUser.userId == reply.user.userId}"
									      th:action="@{/board/comment/reply/delete}" method="post" 
									      class="d-inline"
									      onsubmit="event.stopPropagation(); return checkLoginForAction(event) && confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹?');"
			                            <input type="hidden" name="parentId" th:value="${comment.id}">
			                            <input type="hidden" name="replyId" th:value="${reply.id}">
			                            <button type="submit" class="btn btn-link btn-sm p-0 text-decoration-none text-muted">
											<img src="https://img.icons8.com/ios/20/888888/delete.png" alt="delete" style="vertical-align: middle;"> å‰Šé™¤
			                            </button>
			                        </form>
			                    </div>
			                </div>
			            </div>
			        </div>
			    </div>
			</div>
			
			<!-- ë¡œê·¸ì¸ ìƒíƒœ ìŠ¤í¬ë¦½íŠ¸ -->
			<script th:inline="javascript">
				/*<![CDATA[*/
				const isLoggedIn = /*[[${isLoggedIn}]]*/ false;
				/*]]>*/
						
				// ==== ë¡œê·¸ì¸ ì²´í¬ í•¨ìˆ˜ ====
				function checkLoginForAction(event) {
				        if (!isLoggedIn) {
				            event.preventDefault();
				            if (confirm('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã‹ï¼Ÿ')) {
				                location.href = '/login?returnUrl=' + encodeURIComponent(location.pathname);
				            }
				            return false;
				        }
				        return true;
				    }
			    
				function checkLoginForClick(event) {
				        if (!isLoggedIn) {
				            event.preventDefault();
				            if (confirm('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã‹ï¼Ÿ')) {
				                location.href = '/login?returnUrl=' + encodeURIComponent(location.pathname);
				            }
				        }
				    }
						  
				// ==== ëŒ“ê¸€ ìˆ˜ì • í•¨ìˆ˜ ====  
				function toggleEdit(commentId) {
				    const content = document.getElementById('comment-content-' + commentId);
				    const form = document.getElementById('edit-form-' + commentId);
				    const replyForm = document.getElementById('reply-form-' + commentId);
				    
					// âœ… ëŒ€ëŒ“ê¸€ ì…ë ¥ì°½ ê°•ì œ ë‹«ê¸°
					    if (replyForm) {
					        replyForm.style.display = 'none';
					    }

					    if (form.style.display === 'none' || form.style.display === '') {
					        content.style.display = 'none';
					        form.style.display = 'block';
					    } else {
					        content.style.display = 'block';
					        form.style.display = 'none';
					    }
					}
						    
				function checkLoginAndToggleEdit(event, commentId) {
					event.stopPropagation(); // âœ… ì¶”ê°€
					
			        if (!isLoggedIn) {
			            event.preventDefault();
			            if (confirm('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã‹ï¼Ÿ')) {
			                location.href = '/login?returnUrl=' + encodeURIComponent(location.pathname);
			            }
			        } else {
			            toggleEdit(commentId);
			        }
			    }
						
				// ==== ëŒ€ëŒ“ê¸€ ì…ë ¥ í•¨ìˆ˜ ====    
				function toggleReply(commentId) {
				        const form = document.getElementById('reply-form-' + commentId);
				        if (form.style.display === 'none' || form.style.display === '') {
				            form.style.display = 'block';
				        } else {
				            form.style.display = 'none';
				        }
				    }
					
				// ==== ëŒ€ëŒ“ê¸€ ìˆ˜ì • í•¨ìˆ˜ ====	    
				function toggleReplyEdit(commentId, replyId) {
				        const content = document.getElementById('reply-content-' + commentId + '-' + replyId);
				        const form = document.getElementById('reply-edit-form-' + commentId + '-' + replyId);
				        
				        if (form && content) {
				            if (form.style.display === 'none' || form.style.display === '') {
				                content.style.display = 'none';
				                form.style.display = 'block';
				            } else {
				                content.style.display = 'block';
				                form.style.display = 'none';
				            }
				        }
				    }
				
				function checkLoginAndToggleReplyEdit(event, commentId, replyId) {
				        if (!isLoggedIn) {
				            event.preventDefault();
				            if (confirm('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã‹ï¼Ÿ')) {
				                location.href = '/login?returnUrl=' + encodeURIComponent(location.pathname);
				            }
				        } else {
				            toggleReplyEdit(commentId, replyId);
				        }
				    }
					
				// ==== ì •ë ¬ í•¨ìˆ˜ ====
			    function sortComments(order) {
			        location.href = location.pathname + '?sort=' + order;
			    }
						
				// ==== ê²Œì‹œê¸€ ì‚­ì œ í•¨ìˆ˜ ====
				function deletePost(){
					if(confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')){
						const form = document.createElement('form');
						form.method = 'POST';
						form.action = '/board/delete/[[${board.id}]]';
						document.body.appendChild(form);
						form.submit();
					}
				}
			</script>
			
			<!-- Bootstrap JS -->
			<script src = "https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
			
		</body>
</html>
